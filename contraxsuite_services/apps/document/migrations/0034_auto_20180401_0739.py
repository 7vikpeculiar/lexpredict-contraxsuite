# -*- coding: utf-8 -*-
# Generated by Django 1.11.3 on 2018-04-01 07:39
from __future__ import unicode_literals
from django.db import migrations
from apps.document import constants
from apps.document.models import DocumentType as DocumentTypeClass


def create_generic_document_type(apps, schema_editor):
    Document = apps.get_model('document', 'Document')
    DocumentType = apps.get_model('document', 'DocumentType')
    Project = apps.get_model('project', 'Project')
    obj, _ = DocumentType.objects.get_or_create(uid=constants.DOCUMENT_TYPE_PK_GENERIC_DOCUMENT, defaults={
                'uid': constants.DOCUMENT_TYPE_PK_GENERIC_DOCUMENT,
                'code': DocumentTypeClass.GENERIC_TYPE_CODE,
                'title': 'Generic Document'})
    Project.objects.filter(type__isnull=True).update(type=obj)
    Document.all_objects.filter(document_type__isnull=True).update(document_type=obj)


class Migration(migrations.Migration):

    dependencies = [
        ('document', '0033_auto_20180401_0739'),
    ]

    operations = [
        migrations.RunPython(create_generic_document_type),
    ]
